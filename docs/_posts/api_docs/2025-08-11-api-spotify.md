---
title: Spotify Integration API
date: 2025-08-11 13:45:00 +0000
categories: [API Documentation, Spotify]
tags: [api, spotify, playlists, integration]
---

# Spotify Integration API

The Spotify Integration API provides direct interaction with Spotify's platform for creating and managing playlists. This API works in conjunction with the Playlist API to publish generated playlists to Spotify.

## Base Path: `/spotify`

## Endpoints

### Create Spotify Playlist

```http
POST /spotify/playlists
```

Create a new playlist on Spotify from a draft playlist or provided song list.

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID
- `X-Playlist-ID`: **Required** - Draft playlist ID to create from

#### Request Body

```json
{
  "name": "My AI Playlist",
  "description": "Generated by EchoTuner AI",
  "public": false,
  "songs": [
    {
      "title": "Song Title",
      "artist": "Artist Name",
      "spotify_id": "4iV5W9uYEdYUVa79Axb7Rh"
    }
  ]
}
```

#### Response

```json
{
  "spotify_playlist_id": "37i9dQZF1DX0XUsuxWHRQd",
  "playlist_url": "https://open.spotify.com/playlist/37i9dQZF1DX0XUsuxWHRQd"
}
```

#### Example

```bash
curl -X POST "https://echotuner-api.domax.lt/spotify/playlists" \
  -H "X-User-ID: user_12345" \
  -H "X-Playlist-ID: playlist_67890" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "AI Workout Mix",
    "description": "High-energy tracks selected by AI",
    "public": false
  }'
```

---

### Remove Track from Playlist

```http
DELETE /spotify/playlists/{playlist_id}/tracks
```

Remove specific tracks from a Spotify playlist.

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID

#### Request Body

```json
{
  "tracks": [
    {
      "spotify_id": "4iV5W9uYEdYUVa79Axb7Rh"
    },
    {
      "spotify_id": "7qiZfU4dY1lWllzX7mPBI3"
    }
  ]
}
```

#### Response

```json
{
  "removed_count": 2
}
```

#### Example

```bash
curl -X DELETE "https://echotuner-api.domax.lt/spotify/playlists/37i9dQZF1DX0XUsuxWHRQd/tracks" \
  -H "X-User-ID: user_12345" \
  -H "Content-Type: application/json" \
  -d '{
    "tracks": [
      {"spotify_id": "4iV5W9uYEdYUVa79Axb7Rh"}
    ]
  }'
```

---

### Get User's Spotify Playlists

```http
GET /spotify/playlists
```

Retrieve user's existing Spotify playlists (requires Spotify OAuth in normal mode).

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID

#### Response

```json
{
  "playlists": [
    {
      "id": "37i9dQZF1DX0XUsuxWHRQd",
      "name": "My Playlist",
      "description": "A great playlist",
      "public": false,
      "tracks_count": 25,
      "external_urls": {
        "spotify": "https://open.spotify.com/playlist/37i9dQZF1DX0XUsuxWHRQd"
      },
      "created_by_echotuner": true
    }
  ],
  "total": 1
}
```

---

### Get Playlist Details

```http
GET /spotify/playlists/{playlist_id}
```

Get detailed information about a specific Spotify playlist.

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID

#### Response

```json
{
  "id": "37i9dQZF1DX0XUsuxWHRQd",
  "name": "My Playlist",
  "description": "A great playlist",
  "public": false,
  "tracks": [
    {
      "id": "4iV5W9uYEdYUVa79Axb7Rh",
      "name": "Song Title",
      "artists": [
        {
          "name": "Artist Name",
          "id": "4NHQUGzhtTLFvgF5SZesLK"
        }
      ],
      "album": {
        "name": "Album Name",
        "id": "4aawyAB9vmqN3uQ7FjRGTy"
      },
      "duration_ms": 240000,
      "preview_url": "https://p.scdn.co/mp3-preview/...",
      "external_urls": {
        "spotify": "https://open.spotify.com/track/4iV5W9uYEdYUVa79Axb7Rh"
      }
    }
  ],
  "tracks_count": 25,
  "external_urls": {
    "spotify": "https://open.spotify.com/playlist/37i9dQZF1DX0XUsuxWHRQd"
  }
}
```

## Request Models

### SpotifyPlaylistRequest

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | string | ✅ | Playlist name (max 100 characters) |
| `description` | string | ❌ | Playlist description (max 300 characters) |
| `public` | boolean | ❌ | Make playlist public (default: false) |
| `songs` | array | ❌ | Song list (required in shared mode) |

### SpotifyPlaylistTrackRemoveRequest

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `tracks` | array | ✅ | Array of track objects to remove |
| `tracks[].spotify_id` | string | ✅ | Spotify track ID |

### Song Object

| Field | Type | Description |
|-------|------|-------------|
| `title` | string | Song title |
| `artist` | string | Primary artist name |
| `spotify_id` | string | Spotify track ID |
| `preview_url` | string | 30-second preview URL |
| `external_urls` | object | External URLs (Spotify, etc.) |

## Authentication Modes

### Normal Mode
- **User OAuth**: Each user must authenticate with their Spotify account
- **Personal Playlists**: Creates playlists in user's own Spotify account
- **Full Access**: Can read existing playlists and modify them

### Shared Mode
- **Owner OAuth**: Single owner account provides Spotify access
- **Shared Creation**: All users create playlists in owner's account
- **Limited Access**: Users can only create, not read existing playlists
- **Song List Required**: Must provide songs in request (no draft access)

## Rate Limiting

Spotify API calls are subject to Spotify's rate limits:

- **Playlist Creation**: Limited by Spotify's API quotas
- **Track Operations**: Batched for efficiency
- **Read Operations**: Cached to reduce API calls

## Error Handling

### Common Errors

#### 400 Bad Request - Invalid Playlist Data
```json
{
  "detail": "X-Playlist-ID header is required"
}
```

#### 401 Unauthorized - Missing Spotify Token
```json
{
  "detail": "No valid Spotify access token"
}
```

#### 403 Forbidden - Draft Access Denied
```json
{
  "detail": "This draft belongs to a different user"
}
```

#### 404 Not Found - Draft Not Found
```json
{
  "detail": "Draft playlist not found"
}
```

#### 503 Service Unavailable - Spotify Service Down
```json
{
  "detail": "Spotify playlist service not available"
}
```

### Spotify API Errors

When Spotify's API returns errors, they are passed through with context:

#### Rate Limited by Spotify
```json
{
  "detail": "Spotify API rate limit exceeded. Please try again later."
}
```

#### Invalid Spotify Token
```json
{
  "detail": "Spotify access token expired. Please re-authenticate."
}
```

## Best Practices

### Playlist Names
- Keep names under 100 characters
- Use descriptive, meaningful names
- Include context like mood or purpose

### Descriptions
- Provide context about the playlist
- Mention it was generated by AI
- Keep under 300 characters

### Public vs Private
- Default to private for user-generated content
- Only make public with explicit user consent
- Consider user privacy preferences

### Error Handling
- Always check for authentication before making requests
- Handle Spotify rate limits gracefully
- Provide meaningful error messages to users

## Integration Patterns

### Web Application Flow
```javascript
// 1. Generate draft playlist
const draftResponse = await fetch('/playlists?status=draft', {
  method: 'POST',
  headers: {
    'X-User-ID': userId,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    prompt: 'Relaxing evening music'
  })
});

const { playlist_id } = await draftResponse.json();

// 2. Create Spotify playlist
const spotifyResponse = await fetch('/spotify/playlists', {
  method: 'POST',
  headers: {
    'X-User-ID': userId,
    'X-Playlist-ID': playlist_id,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    name: 'Evening Vibes',
    description: 'AI-generated relaxing playlist',
    public: false
  })
});

const { playlist_url } = await spotifyResponse.json();
// Redirect user to playlist_url
```

### Mobile Application Flow
```javascript
// Direct creation with song list (shared mode)
const response = await fetch('/spotify/playlists', {
  method: 'POST',
  headers: {
    'X-User-ID': userId,
    'X-Playlist-ID': draftId,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    name: 'My Workout Mix',
    songs: selectedSongs,
    public: false
  })
});
```

## Next Steps

- **[Playlist Generation API](/posts/api-playlists/)** - Generate playlists to use with Spotify
- **[User Management API](/posts/api-users/)** - Manage user accounts and authentication
- **[Configuration API](/posts/api-config/)** - Check service availability and limits
