---
title: User Management API
date: 2025-08-11 14:00:00 +0000
categories: [API Documentation, Users]
tags: [api, users, profile, rate-limiting]
---

# User Management API

The User Management API provides endpoints for managing user profiles, checking account information, and monitoring rate limiting status.

## Base Path: `/user`

## Endpoints

### Get User Profile

```http
GET /user/profile
```

Retrieve detailed profile information for the authenticated user.

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID

#### Response

```json
{
  "user_id": "user_12345",
  "provider": "spotify",
  "display_name": "John Doe",
  "created_at": "2025-08-01T10:30:00Z",
  "last_used_at": "2025-08-11T14:00:00Z"
}
```

#### Fields Description

| Field | Type | Description |
|-------|------|-------------|
| `user_id` | string | Unique user identifier |
| `provider` | string | Authentication provider (`spotify`, `google`) |
| `display_name` | string | User's display name from provider |
| `created_at` | string | Account creation timestamp (ISO 8601) |
| `last_used_at` | string | Last activity timestamp (ISO 8601) |

#### Example

```bash
curl -X GET "https://api.echotuner.app/user/profile" \
  -H "X-User-ID: user_12345" \
  -H "Content-Type: application/json"
```

---

### Get Rate Limit Status

```http
GET /user/rate-limit-status
```

Check the current rate limiting status for the authenticated user.

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID

#### Response

```json
{
  "user_id": "user_12345",
  "requests_made": 3,
  "max_requests": 10,
  "remaining_requests": 7,
  "reset_time": "2025-08-12T00:00:00Z",
  "can_make_request": true,
  "time_until_reset": "9h 45m"
}
```

#### Fields Description

| Field | Type | Description |
|-------|------|-------------|
| `user_id` | string | User identifier |
| `requests_made` | integer | Number of requests made today |
| `max_requests` | integer | Maximum daily requests allowed |
| `remaining_requests` | integer | Requests remaining today |
| `reset_time` | string | When the limit resets (ISO 8601) |
| `can_make_request` | boolean | Whether user can make more requests |
| `time_until_reset` | string | Human-readable time until reset |

#### Example

```bash
curl -X GET "https://api.echotuner.app/user/rate-limit-status" \
  -H "X-User-ID: user_12345" \
  -H "Content-Type: application/json"
```

---

### Update User Preferences (Future)

```http
PUT /user/preferences
```

> **Note**: This endpoint is planned for future implementation.

Update user-specific preferences and settings.

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID

#### Request Body

```json
{
  "notification_preferences": {
    "email_updates": true,
    "playlist_recommendations": false
  },
  "privacy_settings": {
    "public_playlists": false,
    "share_listening_data": true
  },
  "default_playlist_settings": {
    "default_public": false,
    "default_length": 25,
    "preferred_discovery_strategy": "balanced"
  }
}
```

---

### Delete User Account (Future)

```http
DELETE /user/account
```

> **Note**: This endpoint is planned for future implementation.

Permanently delete user account and all associated data.

#### Headers
- `X-User-ID`: **Required** - Authenticated user ID

#### Response

```json
{
  "success": true,
  "message": "Account deletion initiated",
  "deletion_id": "del_abc123",
  "estimated_completion": "2025-08-18T14:00:00Z"
}
```

## Rate Limiting Details

### Daily Limits

Rate limits are enforced per user ID and reset daily at UTC midnight:

- **Default Limit**: 10 playlists per day (configurable)
- **Premium Users**: Higher limits (future feature)
- **Shared Mode**: Limits apply per Google account user

### Rate Limit Calculation

```javascript
// Check if user can make request
const rateLimitCheck = async (userId) => {
  const response = await fetch('/user/rate-limit-status', {
    headers: { 'X-User-ID': userId }
  });
  
  const data = await response.json();
  
  if (!data.can_make_request) {
    throw new Error(`Rate limit exceeded. ${data.remaining_requests} requests remaining. Resets in ${data.time_until_reset}`);
  }
  
  return data;
};
```

### Rate Limit Headers

Some endpoints include rate limit information in response headers:

```http
X-RateLimit-Limit: 10
X-RateLimit-Remaining: 7
X-RateLimit-Reset: 1660176000
```

## Error Handling

### Common Errors

#### 401 Unauthorized - Invalid User ID
```json
{
  "detail": "Invalid user ID. Please authenticate first."
}
```

#### 404 Not Found - User Not Found
```json
{
  "detail": "User not found"
}
```

#### 429 Too Many Requests - Rate Limited
```json
{
  "detail": "Daily limit of 10 playlists reached. Try again tomorrow."
}
```

#### 500 Internal Server Error - Server Error
```json
{
  "detail": "Failed to retrieve profile information"
}
```

## Account Types

### Normal Mode Users
- **Provider**: `spotify`
- **Authentication**: Individual Spotify OAuth
- **Playlists**: Created in user's own Spotify account
- **Rate Limits**: Per individual user

### Shared Mode Users
- **Provider**: `google`
- **Authentication**: Google OAuth
- **Playlists**: Created in shared owner's Spotify account
- **Rate Limits**: Per Google account user

## User Lifecycle

### Account Creation
1. User completes OAuth flow
2. Account record created in database
3. User ID generated and returned
4. Rate limiting tracking initialized

### Account Usage
1. User makes authenticated requests
2. Last used timestamp updated
3. Rate limit counters incremented
4. Activity tracking for analytics

### Account Maintenance
- **Inactive Accounts**: Cleaned up after extended periods
- **Rate Limit Reset**: Daily at UTC midnight
- **Token Refresh**: Handled automatically

## Integration Examples

### React Application

```javascript
import { useState, useEffect } from 'react';

const UserProfile = ({ userId }) => {
  const [profile, setProfile] = useState(null);
  const [rateLimit, setRateLimit] = useState(null);

  useEffect(() => {
    const fetchUserData = async () => {
      try {
        // Get profile
        const profileResponse = await fetch('/user/profile', {
          headers: { 'X-User-ID': userId }
        });
        const profileData = await profileResponse.json();
        setProfile(profileData);

        // Get rate limit status
        const rateLimitResponse = await fetch('/user/rate-limit-status', {
          headers: { 'X-User-ID': userId }
        });
        const rateLimitData = await rateLimitResponse.json();
        setRateLimit(rateLimitData);

      } catch (error) {
        console.error('Failed to fetch user data:', error);
      }
    };

    fetchUserData();
  }, [userId]);

  return (
    <div>
      {profile && (
        <div>
          <h2>Welcome, {profile.display_name}!</h2>
          <p>Account created: {new Date(profile.created_at).toLocaleDateString()}</p>
          <p>Provider: {profile.provider}</p>
        </div>
      )}
      
      {rateLimit && (
        <div>
          <h3>Usage Today</h3>
          <p>{rateLimit.requests_made} of {rateLimit.max_requests} playlists generated</p>
          <p>{rateLimit.remaining_requests} remaining</p>
          {!rateLimit.can_make_request && (
            <p>Limit reached. Resets in {rateLimit.time_until_reset}</p>
          )}
        </div>
      )}
    </div>
  );
};
```

### Mobile Application

```javascript
// Check rate limit before making playlist request
const generatePlaylist = async (userId, prompt) => {
  try {
    // Check rate limit first
    const rateLimitResponse = await fetch('/user/rate-limit-status', {
      headers: { 'X-User-ID': userId }
    });
    const rateLimit = await rateLimitResponse.json();

    if (!rateLimit.can_make_request) {
      throw new Error(`Daily limit reached. Try again in ${rateLimit.time_until_reset}`);
    }

    // Proceed with playlist generation
    const playlistResponse = await fetch('/playlists', {
      method: 'POST',
      headers: {
        'X-User-ID': userId,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ prompt })
    });

    return await playlistResponse.json();

  } catch (error) {
    console.error('Playlist generation failed:', error);
    throw error;
  }
};
```

## Next Steps

- **[Personality API](/posts/api-personality/)** - Manage user music preferences
- **[Configuration API](/posts/api-config/)** - Get rate limiting and feature settings
- **[Authentication API](/posts/api-authentication/)** - User authentication flows
